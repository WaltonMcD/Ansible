--- # Bootstrap Webservers
- hosts: webservers
  become: yes
  gather_facts: yes

  tasks:
  - name: latest httpd server
    yum:
      name: httpd
      state: latest

  - name: create index.html file
    file:
      name: /var/www/html/index.html
      state: touch

  - name: web content
    lineinfile:
      line: "Hello World From {{ ansible_hostname }}"
      path: /var/www/html/index.html
    notify:
      - restart httpd

  - name: start apache httpd
    service:
      name: httpd
      state: started
    register: task_start_httpd

  - debug:
    msg: "Output of starting httpd: {{ task_start_httpd }}"

  - name: enable apache httpd
    service:
      name: httpd
      state: enabled

  # If contents of index.html are changed we will restart httpd
  handlers:
  - name: restart httpd
    service:
      name: httpd
      state: restarted
    listen: "restart httpd"